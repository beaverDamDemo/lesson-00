"use strict";
"use strict";function shuffle(e){for(var t,a,n=e.length;0!==n;)a=Math.floor(Math.random()*n),n-=1,t=e[n],e[n]=e[a],e[a]=t;return e}!function(){function e(){p=shuffle(m),t(),a(),$(".innerDropAreas").css("border","2px solid brown"),$("#steps-wrapper").addClass("step-1"),l.removeClass("loading")}function t(){for(var e=0;5>e;e++){$("#back-"+(e+1)).append("<img src='images/"+p[e][0]+"' alt='' />");var t="<div class='magnets magnetUp-0 rot0' id='magnet-"+(e+1)+"-0'>",a="<div class='rotate-wrapper-up0 rotate-0'>",s="<img src='images/magnet1.jpg' alt=''>",o="</div></div>",r=t+a+s+o;$("#step-"+(e+1)).append(r),t="<div class='magnets magnetLo-0 rot0' id='magnet-"+(e+1)+"-1'>",a="<div class='rotate-wrapper-lo0 rotate-0'>",s="<img src='images/magnet2.jpg' alt=''>",o="</div></div>",r=t+a+s+o,$("#step-"+(e+1)).append(r),t="<div class='magnets hidden magnetUp-1 rot0' id='magnet-"+(e+1)+"-2'>",a="<div class='rotate-wrapper-up1 rotate-0'>",s="<img src='images/magnet1.jpg' alt=''>",o="</div></div>",r=t+a+s+o,$("#step-"+(e+1)).append(r),t="<div class='magnets hidden magnetLo-1 rot0' id='magnet-"+(e+1)+"-3'>",a="<div class='rotate-wrapper-lo1 rotate-0'>",s="<img src='images/magnet2.jpg' alt=''>",o="</div></div>",r=t+a+s+o,$("#step-"+(e+1)).append(r);var c='<div class="rotateButton rotateButtonUpper-0" id="rotateButton-',i=e+1+'-0"></div>';$("#step-"+(e+1)).append(c+i),c='<div class="rotateButton rotateButtonLower-0" id="rotateButton-',i=e+1+'-1"></div>',$("#step-"+(e+1)).append(c+i),c='<div class="rotateButton rotateButtonUpper-1 disabled" id="rotateButton-',i=e+1+'-2"></div>',$("#step-"+(e+1)).append(c+i),c='<div class="rotateButton rotateButtonLower-1 disabled" id="rotateButton-',i=e+1+'-3"></div>',$("#step-"+(e+1)).append(c+i);var l='<div class="checkButton disabled" id="checkButton-',d=e+1+'"></div>';$("#step-"+(e+1)).append(l+d),$(".steps").addClass("active"),$(".steps").removeClass("active"),$("#step-1").addClass("active"),n(e+1)}}function a(){for(var e=0;5>e;e++){for(var t=0;t<p[e][2].length;t++){var a=p[e][2][t],n='<div class="innerDropAreas wrong" data-target-magnet='+p[e][1][t][0]+" data-target-rotate="+p[e][1][t][1]+" id="+a+"></div>";$("#step-"+(e+1)).append(n)}f.push(p[e][2])}}function n(e){d=$("#step-"+e+" .magnets"),u=Draggable.create(d,{bounds:window,cursor:"pointer",onPress:function(){this.startX=this.x,this.startY=this.y,void 0==d.startX&&(d.startX=this.x,d.startY=this.y);for(var t=!1,a=0;a<f[e-1].length;a++)$("#"+f[e-1][a]).hasClass("solved")&&(t=!0);if(0==t){var n=($("#"+this.target.id),this.target.id.substr(this.target.id.length-1));if(2==n)for(var a=0;a<f[e-1].length;a++)$("#"+f[e-1][a]).hasClass("correct")&&$("#"+f[e-1][a]).addClass("solved");else if(3==n)for(var a=0;a<f[e-1].length;a++)$("#"+f[e-1][a]).hasClass("correct")&&$("#"+f[e-1][a]).addClass("solved")}},onDragStart:function(){},onDragEnd:function(t){var a=$("#"+this.target.id);if(Math.abs(this.x-this.startX)>6||Math.abs(this.y-this.startX)>6){o(a);var n=this.target.id.substr(this.target.id.length-1),r=this.target.id.substr(0,this.target.id.length-1);2==n?($("#rotateButton-"+e+"-0").addClass("disabled"),$("#rotateButton-"+e+"-2").removeClass("disabled"),$("#"+r+"0").css("pointer-events","none"),console.log("disabling magnet -0")):3==n&&($("#rotateButton-"+e+"-1").addClass("disabled"),$("#rotateButton-"+e+"-3").removeClass("disabled"),$("#"+r+"1").css("pointer-events","none"),console.log("disabling magnet -1"))}k[i-1]=t,a.addClass("dropped"),$("#checkButton-"+i).removeClass("disabled");for(var c=0;c<f[e-1].length;c++)if($(".magnets").css("box-shadow","0 0 6px 3px greenyellow"),this.hitTest($("#"+f[e-1][c]),h)){var l=this.target.id.substr(this.target.id.length-1),d=parseInt(l)+2,u=this.target.id.slice(0,-1),p=u+d;$("#"+p).removeClass("hidden");var g=$("#step-"+e+" .innerDropAreas").attr("data-target-magnet"),b=$("#"+f[e-1][c]).attr("data-target-rotate");$("#"+f[e-1][c]).removeClass("wrong");var m=s($(this.target),g,b);$("#"+f[e-1][c]).addClass(m,g,b)}else $("#"+f[e-1][c]).hasClass("solved")||($("#"+f[e-1][c]).removeClass("correct solved"),$("#"+f[e-1][c]).addClass("wrong"))}}),b.push(u)}function s(e,t,a){var n="",s="magnetUp";if((e.hasClass("magnetLo-0")||e.hasClass("magnetLo-1"))&&(s="magnetLo",n+="magnets Not matching. "),s==t){n+="magnets matching. ";var o=void 0;return e.hasClass("rot0")?o=0:e.hasClass("rot90")?o=90:e.hasClass("rot180")?o=180:e.hasClass("rot270")?o=270:n+="something went wrong. ",o==a?(n+="All GOOD. returning CORRECT and disabling magnet click. ","correct"):(n+="rotation not matching. returning wrong. ","wrong")}return n+="magnets not matching. returning wrong. ","wrong"}function o(e){var t=e.attr("id").substr(e.attr("id").length-1),a=e.attr("id").slice(0,-1),n=parseInt(t)+2,s=a+n;$("#"+s).removeClass("hidden");a.substr(a.length-2,1)}function r(){$("#step-"+i).find(".magnets").css({"pointer-events":"none"}),$("#step-"+i).find(".rotateButton").css({"pointer-events":"none"}).addClass("disabled"),$("#step-"+i).find(".checkButton").css({"pointer-events":"none"}).addClass("disabled")}function c(e){$(".steps").removeClass("active"),$("#step-"+e).addClass("active"),g=0}var i=($("#steps-wrapper"),1),l=$("body");l.addClass("loading");var d,u,p,g=0,h="95%",b=[],f=[],k=[],m=[["fieldLines0.png",[["magnetUp",180]],["ida0"]],["fieldLines1.png",[["magnetUp",0]],["ida1"]],["fieldLines2.png",[["magnetUp",270]],["ida2"]],["fieldLines3.png",[["magnetUp",90]],["ida3"]],["fieldLines4.png",[["magnetLo",270]],["ida4"]],["fieldLines5.png",[["magnetLo",90]],["ida5"]],["fieldLines6.png",[["magnetLo",180]],["ida6"]],["fieldLines7.png",[["magnetLo",0]],["ida7"]],["fieldLines8.png",[["magnetUp",270],["magnetUp",90]],["ida8left","ida8right"]],["fieldLines9.png",[["magnetUp",270],["magnetUp",270]],["ida9left","ida9right"]],["fieldLines10.png",[["magnetUp",90]],["ida10"]],["fieldLines11.png",[["magnetUp",270]],["ida11"]],["fieldLines12.png",[["magnetUp",0]],["ida12"]],["fieldLines13.png",[["magnetUp",180]],["ida13"]],["fieldLines14.png",[["magnetLo",270]],["ida14"]],["fieldLines15.png",[["magnetLo",90]],["ida15"]],["fieldLines16.png",[["magnetLo",180]],["ida16"]],["fieldLines17.png",[["magnetLo",0]],["ida17"]]];e(),$(".wrapper").on("click",".checkButton",function(){g++;var e=!0,t=$("#step-"+i).find(".innerDropAreas");console.log("this step dropareas: ",t.length);var a=0;$("#magnet-"+i+"-0").hasClass("dropped")&&a++,$("#magnet-"+i+"-1").hasClass("dropped")&&a++,$("#magnet-"+i+"-2").hasClass("dropped")&&a++,console.log("dropped magnets: ",a),a!=t.length&&(e=!1);for(var n=$("#step-"+i).find(".magnets"),s=0;s<t.length;s++)d.startX=void 0,$("#"+t[s].id).hasClass("correct")||(e=!1);if(1==e)r();else{n.addClass("shakeAnimation"),setTimeout(function(){n.removeClass("shakeAnimation")},1500),TweenLite.to($(".magnets"),.15,{x:0,y:0});for(var s=0;s<t.length;s++)$("#"+t[s].id).removeClass("correct solved").addClass("wrong");$("#rotateButton-"+i+"-0").removeClass("disabled"),$("#rotateButton-"+i+"-1").removeClass("disabled"),$("#rotateButton-"+i+"-2").addClass("disabled"),$("#rotateButton-"+i+"-3").addClass("disabled"),$("#rotateButton-"+i+"-2").removeClass("active"),$("#rotateButton-"+i+"-3").removeClass("active"),$("#magnet-"+i+"-0").css("pointer-events","auto"),$("#magnet-"+i+"-0").removeClass("dropped"),$("#magnet-"+i+"-1").css("pointer-events","auto"),$("#magnet-"+i+"-1").removeClass("dropped"),$("#magnet-"+i+"-2").removeClass("active").addClass("hidden"),$("#magnet-"+i+"-3").removeClass("active").addClass("hidden")}g>=5&&(console.log("User run out of chances."),r())}),$(".wrapper").on("click",".rotateButton",function(){var e=this.id.substr(this.id.length-3,this.id.length),t=this.id.substr(this.id.length-1,1),a=$("#magnet-"+e);TweenLite.to(a,.166,{rotation:"+=90"}),a.hasClass("rot90")?(a.removeClass("rot90").addClass("rot180"),a.children().removeClass("rotate-90").addClass("rotate-180")):a.hasClass("rot180")?(a.removeClass("rot180").addClass("rot270"),a.children().removeClass("rotate-180").addClass("rotate-270")):a.hasClass("rot270")?(a.removeClass("rot270").addClass("rot0"),a.children().removeClass("rotate-270").addClass("rotate-0")):(a.removeClass("rot0").addClass("rot90"),a.children().removeClass("rotate-0").addClass("rotate-90")),$(".rotateButton").css("pointer-events","none"),setTimeout(function(){$(".rotateButton").css("pointer-events","auto")},200);var n=this.id.substr(this.id.length-3,1);setTimeout(function(){b[n-1][t].startDrag(k[n-1]),b[n-1][t].endDrag(k[n-1])},400)}),$(nextButton).on("click",function(){console.log(" currentstep before change: ",i),5>i&&(i++,console.log("New currentStep: ",i),c(i))}),$(backButton).on("click",function(){console.log(" currentstep before change: ",i),i>1&&(i--,console.log("New currentStep: ",i),c(i))})}();
