"use strict";
"use strict";

var Stepper = (function () {
  "use strict";function e(e) {
    u();var t = $(e.target).hasClass("backward") ? "back" : "forward";$(Stepper).trigger("stepperClicked", { direction: t }), s();
  }var t = $(".stepper-icon.backward"),
      n = $(".stepper-icon.forward"),
      r = $(".stepper-text .steps-current"),
      o = $(".stepper-text .steps-total"),
      i = "click",
      a = 0,
      c = 0,
      s = function s() {
    t.on(i, e), n.on(i, e);
  },
      u = function u() {
    t.off(i, e), n.off(i, e);
  },
      p = function p(e) {
    a = e, o.text(a);
  },
      l = function l(e) {
    c = e, 1 === c ? f("b") : g("b"), c === a ? (f("f"), console.log("MAX")) : g("f"), r.text(c);
  },
      f = function f(e) {
    ("back" === e || "b" === e) && (t.addClass("invisible"), t.css("visibility", "hidden")), ("forward" === e || "f" === e) && (n.addClass("invisible"), n.css("visibility", "hidden"));
  },
      g = function g(e) {
    ("back" === e || "b" === e) && c > 0 && (t.removeClass("invisible"), t.css("visibility", "visible")), ("forward" === e || "f" === e) && a > c && (n.removeClass("invisible"), n.css("visibility", "visible"));
  };return (f("b"), s(), { setMaxSteps: p, setCurrentStep: l, hideIcon: f, showIcon: g });
})();
"use strict";var ShuffleArray = function ShuffleArray(t) {
  for (var e, n, a = t.length; a; e = Math.floor(Math.random() * a), n = t[--a], t[a] = t[e], t[e] = n);return t;
};
"use strict";!function(){function t(){FastClick.attach(document.body),v=i18n.t("items",{returnObjectTrees:!0}),ShuffleArray(v),e(),s(),$(".innerDropAreas").css("border","2px solid brown"),$("#steps-wrapper").addClass("step-1"),p.removeClass("loading")}function e(){for(var t=0;5>t;t++){$("#back-"+(t+1)).append("<img src='images/"+v[t][0]+"' alt='' />");var e="<div class='magnets magnetUp-0 rot0' id='magnet-"+(t+1)+"-0'>",s="<div class='rotate-wrapper-up0 rotate-0'>",r="<img src='images/magnet1.png' alt=''>",n="</div></div>",o=e+s+r+n;$("#step-"+(t+1)).append(o),e="<div class='magnets magnetLo-0 rot0' id='magnet-"+(t+1)+"-1'>",s="<div class='rotate-wrapper-lo0 rotate-0'>",r="<img src='images/magnet2.png' alt=''>",n="</div></div>",o=e+s+r+n,$("#step-"+(t+1)).append(o),e="<div class='magnets hidden magnetUp-1 rot0' id='magnet-"+(t+1)+"-2'>",s="<div class='rotate-wrapper-up1 rotate-0'>",r="<img src='images/magnet1.png' alt=''>",n="</div></div>",o=e+s+r+n,$("#step-"+(t+1)).append(o),e="<div class='magnets hidden magnetLo-1 rot0' id='magnet-"+(t+1)+"-3'>",s="<div class='rotate-wrapper-lo1 rotate-0'>",r="<img src='images/magnet2.png' alt=''>",n="</div></div>",o=e+s+r+n,$("#step-"+(t+1)).append(o);var i='<div class="rotateButton rotateButtonUpper-0" id="rotateButton-',d=t+1+'-0"></div>';$("#step-"+(t+1)).append(i+d),i='<div class="rotateButton rotateButtonLower-0" id="rotateButton-',d=t+1+'-1"></div>',$("#step-"+(t+1)).append(i+d),i='<div class="rotateButton rotateButtonUpper-1 disabled" id="rotateButton-',d=t+1+'-2"></div>',$("#step-"+(t+1)).append(i+d),i='<div class="rotateButton rotateButtonLower-1 disabled" id="rotateButton-',d=t+1+'-3"></div>',$("#step-"+(t+1)).append(i+d);var l='<div class="checkButton disabled" id="checkButton-',p=t+1+'"></div>';$("#step-"+(t+1)).append(l+p),$(".steps").addClass("active"),$(".steps").removeClass("active"),$("#step-1").addClass("active"),a(t+1)}}function s(){for(var t=0;5>t;t++){for(var e=0;e<v[t][2].length;e++){var s=v[t][2][e],a='<div class="innerDropAreas wrong" data-target-magnet='+v[t][1][e][0]+" data-target-rotate="+v[t][1][e][1]+" id="+s+"></div>";$("#step-"+(t+1)).append(a)}C.push(v[t][2])}}function a(t){g=$("#step-"+t+" .magnets"),c=Draggable.create(g,{bounds:window,cursor:"pointer",onPress:function(){this.startX=this.x,this.startY=this.y,void 0==g.startX&&(g.startX=this.x,g.startY=this.y);for(var e=!1,s=0;s<C[t-1].length;s++)$("#"+C[t-1][s]).hasClass("solved")&&(e=!0);if(0==e){var a=($("#"+this.target.id),this.target.id.substr(this.target.id.length-1));if(2==a)for(var s=0;s<C[t-1].length;s++)$("#"+C[t-1][s]).hasClass("correct")&&$("#"+C[t-1][s]).addClass("solved");else if(3==a)for(var s=0;s<C[t-1].length;s++)$("#"+C[t-1][s]).hasClass("correct")&&$("#"+C[t-1][s]).addClass("solved")}},onDragStart:function(){},onDragEnd:function(e){var s=$("#"+this.target.id);if(Math.abs(this.x-this.startX)>6||Math.abs(this.y-this.startX)>6){n(s);var a=this.target.id.substr(this.target.id.length-1),o=this.target.id.substr(0,this.target.id.length-1);2==a?($("#rotateButton-"+t+"-0").addClass("disabled"),$("#rotateButton-"+t+"-2").removeClass("disabled"),$("#"+o+"0").css("pointer-events","none")):3==a&&($("#rotateButton-"+t+"-1").addClass("disabled"),$("#rotateButton-"+t+"-3").removeClass("disabled"),$("#"+o+"1").css("pointer-events","none"))}f[l-1]=e,s.addClass("dropped"),$("#checkButton-"+l).removeClass("disabled");for(var i=0;i<C[t-1].length;i++)if($(".magnets").css("box-shadow","0 0 6px 3px greenyellow"),this.hitTest($("#"+C[t-1][i]),h)){var d=this.target.id.substr(this.target.id.length-1),p=parseInt(d)+2,g=this.target.id.slice(0,-1),c=g+p;$("#"+c).removeClass("hidden");var v=$("#step-"+t+" .innerDropAreas").attr("data-target-magnet"),m=$("#"+C[t-1][i]).attr("data-target-rotate");$("#"+C[t-1][i]).removeClass("wrong");var u=r($(this.target),v,m);$("#"+C[t-1][i]).addClass(u,v,m)}else $("#"+C[t-1][i]).hasClass("solved")||($("#"+C[t-1][i]).removeClass("correct solved"),$("#"+C[t-1][i]).addClass("wrong"))}}),u.push(c)}function r(t,e,s){var a="",r="magnetUp";if((t.hasClass("magnetLo-0")||t.hasClass("magnetLo-1"))&&(r="magnetLo",a+="magnets Not matching. "),r==e){a+="magnets matching. ";var n=void 0;return t.hasClass("rot0")?n=0:t.hasClass("rot90")?n=90:t.hasClass("rot180")?n=180:t.hasClass("rot270")?n=270:a+="something went wrong. ",n==s?(a+="All GOOD. returning CORRECT and disabling magnet click. ","correct"):(a+="rotation not matching. returning wrong. ","wrong")}return a+="magnets not matching. returning wrong. ","wrong"}function n(t){var e=t.attr("id").substr(t.attr("id").length-1),s=t.attr("id").slice(0,-1),a=parseInt(e)+2,r=s+a;$("#"+r).removeClass("hidden");s.substr(s.length-2,1)}function o(){$("#step-"+l).find(".magnets").css({"pointer-events":"none"}),$("#step-"+l).find(".rotateButton").css({"pointer-events":"none"}).addClass("disabled"),$("#step-"+l).find(".checkButton").css({"pointer-events":"none"}).addClass("disabled")}function i(t,e){"back"===e.direction?l--:l++,Stepper.setCurrentStep(l),d(l)}function d(t){$(".steps").removeClass("active"),$("#step-"+t).addClass("active"),m=0}$(document).one("i18nComplete",t);var l=($("#steps-wrapper"),1);Stepper.setMaxSteps(5),$(Stepper).on("stepperClicked",i);var p=$("body");p.addClass("loading");var g,c,v=[],m=0,h="95%",u=[],C=[],f=[];$(".wrapper").on("click",".checkButton",function(){m++;var t=!0,e=$("#step-"+l).find(".innerDropAreas"),s=0;$("#magnet-"+l+"-0").hasClass("dropped")&&s++,$("#magnet-"+l+"-1").hasClass("dropped")&&s++,$("#magnet-"+l+"-2").hasClass("dropped")&&s++,s!=e.length&&(t=!1);for(var a=$("#step-"+l).find(".magnets"),r=0;r<e.length;r++)g.startX=void 0,$("#"+e[r].id).hasClass("correct")||(t=!1);if(1==t)o();else{a.addClass("shakeAnimation"),setTimeout(function(){a.removeClass("shakeAnimation")},1500),TweenLite.to($(".magnets"),.15,{x:0,y:0});for(var r=0;r<e.length;r++)$("#"+e[r].id).removeClass("correct solved").addClass("wrong");$("#rotateButton-"+l+"-0").removeClass("disabled"),$("#rotateButton-"+l+"-1").removeClass("disabled"),$("#rotateButton-"+l+"-2").addClass("disabled"),$("#rotateButton-"+l+"-3").addClass("disabled"),$("#rotateButton-"+l+"-2").removeClass("active"),$("#rotateButton-"+l+"-3").removeClass("active"),$("#magnet-"+l+"-0").css("pointer-events","auto"),$("#magnet-"+l+"-0").removeClass("dropped"),$("#magnet-"+l+"-1").css("pointer-events","auto"),$("#magnet-"+l+"-1").removeClass("dropped"),$("#magnet-"+l+"-2").removeClass("active").addClass("hidden"),$("#magnet-"+l+"-3").removeClass("active").addClass("hidden")}m>=5&&o()}),$(".wrapper").on("click",".rotateButton",function(){var t=this.id.substr(this.id.length-3,this.id.length),e=this.id.substr(this.id.length-1,1),s=$("#magnet-"+t);TweenLite.to(s,.166,{rotation:"+=90"}),s.hasClass("rot90")?(s.removeClass("rot90").addClass("rot180"),s.children().removeClass("rotate-90").addClass("rotate-180")):s.hasClass("rot180")?(s.removeClass("rot180").addClass("rot270"),s.children().removeClass("rotate-180").addClass("rotate-270")):s.hasClass("rot270")?(s.removeClass("rot270").addClass("rot0"),s.children().removeClass("rotate-270").addClass("rotate-0")):(s.removeClass("rot0").addClass("rot90"),s.children().removeClass("rotate-0").addClass("rotate-90")),$(".rotateButton").css("pointer-events","none"),setTimeout(function(){$(".rotateButton").css("pointer-events","auto")},200);var a=this.id.substr(this.id.length-3,1);setTimeout(function(){u[a-1][e].startDrag(f[a-1]),u[a-1][e].endDrag(f[a-1])},400)})}();
